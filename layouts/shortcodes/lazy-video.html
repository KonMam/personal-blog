<!-- layouts/shortcodes/lazy-video.html -->
<div class="lazy-video-container" style="display: flex; justify-content: center; align-items: center; width: 100%; max-width: {{ .Get "width" }}px; margin: 0 auto;">
  <video
    style="opacity: 0; transition: opacity 0.5s; width: 100%; height: auto;"
    loop
    muted
    playsinline
    autoplay
    data-src-mp4="{{ .Get "mp4" }}"
  >
  </video>
</div>

<script>
window.addEventListener('load', function() {
  const videos = document.querySelectorAll('.lazy-video-container video');
  videos.forEach(video => {
    const mp4Src = video.getAttribute('data-src-mp4');

    if (mp4Src) {
      const sourceMp4 = document.createElement('source');
      sourceMp4.setAttribute('src', mp4Src);
      sourceMp4.setAttribute('type', 'video/mp4');
      video.appendChild(sourceMp4);
    }

    video.load();
    video.oncanplaythrough = () => {
      video.style.opacity = 1;
    };
  });
});
</script>
